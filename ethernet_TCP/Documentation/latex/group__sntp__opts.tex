\hypertarget{group__sntp__opts}{}\doxysection{Options}
\label{group__sntp__opts}\index{Options@{Options}}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gafe340b98c52dedcbc041267fe13b2da6}{SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME}}(sec)~\mbox{\hyperlink{group__compiler__abstraction_ga70624a5deb8b9199406372a7f3603ecf}{LWIP\+\_\+\+UNUSED\+\_\+\+ARG}}(sec)
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga5d9dc0827f402849f5c18d44e311dbc2}{SNTP\+\_\+\+MAX\+\_\+\+SERVERS}}~\mbox{\hyperlink{group__lwip__opts__dhcp_ga9d014e3f7dc9e1e7c7decd8652ba65e2}{LWIP\+\_\+\+DHCP\+\_\+\+MAX\+\_\+\+NTP\+\_\+\+SERVERS}}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga961a61eef942ab5378cff1e3742b3ade}{SNTP\+\_\+\+GET\+\_\+\+SERVERS\+\_\+\+FROM\+\_\+\+DHCP}}~\mbox{\hyperlink{group__lwip__opts__dhcp_ga2cc18315edcd5ffc083d1256f7d22a83}{LWIP\+\_\+\+DHCP\+\_\+\+GET\+\_\+\+NTP\+\_\+\+SRV}}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gaef477c145ae404d77188b26b79b6996f}{SNTP\+\_\+\+SERVER\+\_\+\+DNS}}~0
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga25c6f9c14c17e218d110d826b09f8d91}{SNTP\+\_\+\+DEBUG}}~\mbox{\hyperlink{group__debugging__levels_gadab1cdc3f45939a3a5c9a3d7e04987e1}{LWIP\+\_\+\+DBG\+\_\+\+OFF}}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gacbee62c27f54371fc2c5259a834a0f9b}{SNTP\+\_\+\+PORT}}~\mbox{\hyperlink{group__iana_ggac9396d90585e49e9a287179bf5aa9ba0a79c377ce09e05cd4410a8865d41b3efb}{LWIP\+\_\+\+IANA\+\_\+\+PORT\+\_\+\+SNTP}}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga7d4e12d90912d486e64f289d7f3ca446}{SNTP\+\_\+\+CHECK\+\_\+\+RESPONSE}}~0
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga1e21781705d3549a305339fd7fca63e7}{SNTP\+\_\+\+COMP\+\_\+\+ROUNDTRIP}}~0
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga22017d43da7d4bf8d42e786b4ced4dfa}{SNTP\+\_\+\+STARTUP\+\_\+\+DELAY}}~0
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gae082c2f3044d500ca5e1be1d4928de75}{SNTP\+\_\+\+STARTUP\+\_\+\+DELAY\+\_\+\+FUNC}}~(LWIP\+\_\+\+RAND() \% 5000)
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga44cf26b9b19832d88599244711a12d08}{SNTP\+\_\+\+RECV\+\_\+\+TIMEOUT}}~15000
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga9232c56443115be05a2f852eba21979c}{SNTP\+\_\+\+UPDATE\+\_\+\+DELAY}}~3600000
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gab0ea385479a5c5c8c173f165ded2fb63}{SNTP\+\_\+\+GET\+\_\+\+SYSTEM\+\_\+\+TIME}}(sec,  us)~do \{ (sec) = 0; (us) = 0; \} while(0)
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga86d651d8eb07687208308deef95a23ba}{SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT}}~\mbox{\hyperlink{group__sntp__opts_ga44cf26b9b19832d88599244711a12d08}{SNTP\+\_\+\+RECV\+\_\+\+TIMEOUT}}
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gafde10b3ed7cb4bb2cd2c4daa389db699}{SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT\+\_\+\+MAX}}~(\mbox{\hyperlink{group__sntp__opts_ga86d651d8eb07687208308deef95a23ba}{SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT}} $\ast$ 10)
\item 
\#define \mbox{\hyperlink{group__sntp__opts_gafdb7e98f608cc429188d7dac356614c2}{SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT\+\_\+\+EXP}}~1
\item 
\#define \mbox{\hyperlink{group__sntp__opts_ga5782f21ef24ebddd5ba2ce9a889094e3}{SNTP\+\_\+\+MONITOR\+\_\+\+SERVER\+\_\+\+REACHABILITY}}~1
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{group__sntp__opts_ga7d4e12d90912d486e64f289d7f3ca446}\label{group__sntp__opts_ga7d4e12d90912d486e64f289d7f3ca446}} 
\index{Options@{Options}!SNTP\_CHECK\_RESPONSE@{SNTP\_CHECK\_RESPONSE}}
\index{SNTP\_CHECK\_RESPONSE@{SNTP\_CHECK\_RESPONSE}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_CHECK\_RESPONSE}{SNTP\_CHECK\_RESPONSE}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+CHECK\+\_\+\+RESPONSE~0}

Sanity check\+: Define this to
\begin{DoxyItemize}
\item 0 to turn off sanity checks (default; smaller code)
\item \texorpdfstring{$>$}{>}= 1 to check address and port of the response packet to ensure the response comes from the server we sent the request to.
\item \texorpdfstring{$>$}{>}= 2 to check returned Originate Timestamp against Transmit Timestamp sent to the server (to ensure response to older request).
\item \texorpdfstring{$>$}{>}= 3 \begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000006}{Todo}}]\+: discard reply if any of the VN, Stratum, or Transmit Timestamp fields is 0 or the Mode field is not 4 (unicast) or 5 (broadcast).\end{DoxyRefDesc}

\end{DoxyItemize}\mbox{\Hypertarget{group__sntp__opts_ga1e21781705d3549a305339fd7fca63e7}\label{group__sntp__opts_ga1e21781705d3549a305339fd7fca63e7}} 
\index{Options@{Options}!SNTP\_COMP\_ROUNDTRIP@{SNTP\_COMP\_ROUNDTRIP}}
\index{SNTP\_COMP\_ROUNDTRIP@{SNTP\_COMP\_ROUNDTRIP}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_COMP\_ROUNDTRIP}{SNTP\_COMP\_ROUNDTRIP}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+COMP\+\_\+\+ROUNDTRIP~0}

Enable round-\/trip delay compensation. Compensate for the round-\/trip delay by calculating the clock offset from the originate, receive, transmit and destination timestamps, as per RFC.

The calculation requires compiler support for 64-\/bit integers. Also, either SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+US or SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+NTP has to be implemented for setting the system clock with sub-\/second precision. Likewise, either SNTP\+\_\+\+GET\+\_\+\+SYSTEM\+\_\+\+TIME or SNTP\+\_\+\+GET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+NTP needs to be implemented with sub-\/second precision.

Although not strictly required, it makes sense to combine this option with SNTP\+\_\+\+CHECK\+\_\+\+RESPONSE \texorpdfstring{$>$}{>}= 2 for sanity-\/checking of the received timestamps. Also, in order for the round-\/trip calculation to work, the difference between the local clock and the NTP server clock must not be larger than about 34 years. If that limit is exceeded, the implementation will fall back to setting the clock without compensation. In order to ensure that the local clock is always within the permitted range for compensation, even at first try, it may be necessary to store at least the current year in non-\/volatile memory. \mbox{\Hypertarget{group__sntp__opts_ga25c6f9c14c17e218d110d826b09f8d91}\label{group__sntp__opts_ga25c6f9c14c17e218d110d826b09f8d91}} 
\index{Options@{Options}!SNTP\_DEBUG@{SNTP\_DEBUG}}
\index{SNTP\_DEBUG@{SNTP\_DEBUG}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_DEBUG}{SNTP\_DEBUG}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+DEBUG~\mbox{\hyperlink{group__debugging__levels_gadab1cdc3f45939a3a5c9a3d7e04987e1}{LWIP\+\_\+\+DBG\+\_\+\+OFF}}}

SNTP\+\_\+\+DEBUG\+: Enable debugging for SNTP. \mbox{\Hypertarget{group__sntp__opts_ga961a61eef942ab5378cff1e3742b3ade}\label{group__sntp__opts_ga961a61eef942ab5378cff1e3742b3ade}} 
\index{Options@{Options}!SNTP\_GET\_SERVERS\_FROM\_DHCP@{SNTP\_GET\_SERVERS\_FROM\_DHCP}}
\index{SNTP\_GET\_SERVERS\_FROM\_DHCP@{SNTP\_GET\_SERVERS\_FROM\_DHCP}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_GET\_SERVERS\_FROM\_DHCP}{SNTP\_GET\_SERVERS\_FROM\_DHCP}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+GET\+\_\+\+SERVERS\+\_\+\+FROM\+\_\+\+DHCP~\mbox{\hyperlink{group__lwip__opts__dhcp_ga2cc18315edcd5ffc083d1256f7d22a83}{LWIP\+\_\+\+DHCP\+\_\+\+GET\+\_\+\+NTP\+\_\+\+SRV}}}

Set this to 1 to implement the callback function called by dhcp when NTP servers are received. \mbox{\Hypertarget{group__sntp__opts_gab0ea385479a5c5c8c173f165ded2fb63}\label{group__sntp__opts_gab0ea385479a5c5c8c173f165ded2fb63}} 
\index{Options@{Options}!SNTP\_GET\_SYSTEM\_TIME@{SNTP\_GET\_SYSTEM\_TIME}}
\index{SNTP\_GET\_SYSTEM\_TIME@{SNTP\_GET\_SYSTEM\_TIME}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_GET\_SYSTEM\_TIME}{SNTP\_GET\_SYSTEM\_TIME}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+GET\+\_\+\+SYSTEM\+\_\+\+TIME(\begin{DoxyParamCaption}\item[{}]{sec,  }\item[{}]{us }\end{DoxyParamCaption})~do \{ (sec) = 0; (us) = 0; \} while(0)}

SNTP macro to get system time, used with SNTP\+\_\+\+CHECK\+\_\+\+RESPONSE \texorpdfstring{$>$}{>}= 2 to send in request and compare in response. Also used for round-\/trip delay compensation if SNTP\+\_\+\+COMP\+\_\+\+ROUNDTRIP != 0. Alternatively, define SNTP\+\_\+\+GET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+NTP(sec, frac) in order to work with native NTP timestamps instead. \mbox{\Hypertarget{group__sntp__opts_ga5d9dc0827f402849f5c18d44e311dbc2}\label{group__sntp__opts_ga5d9dc0827f402849f5c18d44e311dbc2}} 
\index{Options@{Options}!SNTP\_MAX\_SERVERS@{SNTP\_MAX\_SERVERS}}
\index{SNTP\_MAX\_SERVERS@{SNTP\_MAX\_SERVERS}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_MAX\_SERVERS}{SNTP\_MAX\_SERVERS}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+MAX\+\_\+\+SERVERS~\mbox{\hyperlink{group__lwip__opts__dhcp_ga9d014e3f7dc9e1e7c7decd8652ba65e2}{LWIP\+\_\+\+DHCP\+\_\+\+MAX\+\_\+\+NTP\+\_\+\+SERVERS}}}

The maximum number of SNTP servers that can be set \mbox{\Hypertarget{group__sntp__opts_ga5782f21ef24ebddd5ba2ce9a889094e3}\label{group__sntp__opts_ga5782f21ef24ebddd5ba2ce9a889094e3}} 
\index{Options@{Options}!SNTP\_MONITOR\_SERVER\_REACHABILITY@{SNTP\_MONITOR\_SERVER\_REACHABILITY}}
\index{SNTP\_MONITOR\_SERVER\_REACHABILITY@{SNTP\_MONITOR\_SERVER\_REACHABILITY}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_MONITOR\_SERVER\_REACHABILITY}{SNTP\_MONITOR\_SERVER\_REACHABILITY}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+MONITOR\+\_\+\+SERVER\+\_\+\+REACHABILITY~1}

Keep a reachability shift register per server Default is on to conform to RFC. \mbox{\Hypertarget{group__sntp__opts_gacbee62c27f54371fc2c5259a834a0f9b}\label{group__sntp__opts_gacbee62c27f54371fc2c5259a834a0f9b}} 
\index{Options@{Options}!SNTP\_PORT@{SNTP\_PORT}}
\index{SNTP\_PORT@{SNTP\_PORT}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_PORT}{SNTP\_PORT}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+PORT~\mbox{\hyperlink{group__iana_ggac9396d90585e49e9a287179bf5aa9ba0a79c377ce09e05cd4410a8865d41b3efb}{LWIP\+\_\+\+IANA\+\_\+\+PORT\+\_\+\+SNTP}}}

SNTP server port \mbox{\Hypertarget{group__sntp__opts_ga44cf26b9b19832d88599244711a12d08}\label{group__sntp__opts_ga44cf26b9b19832d88599244711a12d08}} 
\index{Options@{Options}!SNTP\_RECV\_TIMEOUT@{SNTP\_RECV\_TIMEOUT}}
\index{SNTP\_RECV\_TIMEOUT@{SNTP\_RECV\_TIMEOUT}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_RECV\_TIMEOUT}{SNTP\_RECV\_TIMEOUT}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+RECV\+\_\+\+TIMEOUT~15000}

SNTP receive timeout -\/ in milliseconds Also used as retry timeout -\/ this shouldn\textquotesingle{}t be too low. Default is 15 seconds. Must not be beolw 15 seconds by specification (i.\+e. 15000) \mbox{\Hypertarget{group__sntp__opts_ga86d651d8eb07687208308deef95a23ba}\label{group__sntp__opts_ga86d651d8eb07687208308deef95a23ba}} 
\index{Options@{Options}!SNTP\_RETRY\_TIMEOUT@{SNTP\_RETRY\_TIMEOUT}}
\index{SNTP\_RETRY\_TIMEOUT@{SNTP\_RETRY\_TIMEOUT}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_RETRY\_TIMEOUT}{SNTP\_RETRY\_TIMEOUT}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT~\mbox{\hyperlink{group__sntp__opts_ga44cf26b9b19832d88599244711a12d08}{SNTP\+\_\+\+RECV\+\_\+\+TIMEOUT}}}

Default retry timeout (in milliseconds) if the response received is invalid. This is doubled with each retry until SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT\+\_\+\+MAX is reached. \mbox{\Hypertarget{group__sntp__opts_gafdb7e98f608cc429188d7dac356614c2}\label{group__sntp__opts_gafdb7e98f608cc429188d7dac356614c2}} 
\index{Options@{Options}!SNTP\_RETRY\_TIMEOUT\_EXP@{SNTP\_RETRY\_TIMEOUT\_EXP}}
\index{SNTP\_RETRY\_TIMEOUT\_EXP@{SNTP\_RETRY\_TIMEOUT\_EXP}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_RETRY\_TIMEOUT\_EXP}{SNTP\_RETRY\_TIMEOUT\_EXP}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT\+\_\+\+EXP~1}

Increase retry timeout with every retry sent Default is on to conform to RFC. \mbox{\Hypertarget{group__sntp__opts_gafde10b3ed7cb4bb2cd2c4daa389db699}\label{group__sntp__opts_gafde10b3ed7cb4bb2cd2c4daa389db699}} 
\index{Options@{Options}!SNTP\_RETRY\_TIMEOUT\_MAX@{SNTP\_RETRY\_TIMEOUT\_MAX}}
\index{SNTP\_RETRY\_TIMEOUT\_MAX@{SNTP\_RETRY\_TIMEOUT\_MAX}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_RETRY\_TIMEOUT\_MAX}{SNTP\_RETRY\_TIMEOUT\_MAX}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT\+\_\+\+MAX~(\mbox{\hyperlink{group__sntp__opts_ga86d651d8eb07687208308deef95a23ba}{SNTP\+\_\+\+RETRY\+\_\+\+TIMEOUT}} $\ast$ 10)}

Maximum retry timeout (in milliseconds). \mbox{\Hypertarget{group__sntp__opts_gaef477c145ae404d77188b26b79b6996f}\label{group__sntp__opts_gaef477c145ae404d77188b26b79b6996f}} 
\index{Options@{Options}!SNTP\_SERVER\_DNS@{SNTP\_SERVER\_DNS}}
\index{SNTP\_SERVER\_DNS@{SNTP\_SERVER\_DNS}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_SERVER\_DNS}{SNTP\_SERVER\_DNS}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+SERVER\+\_\+\+DNS~0}

Set this to 1 to support DNS names (or IP address strings) to set sntp servers One server address/name can be defined as default if SNTP\+\_\+\+SERVER\+\_\+\+DNS == 1\+: \#define SNTP\+\_\+\+SERVER\+\_\+\+ADDRESS \char`\"{}pool.\+ntp.\+org\char`\"{} \mbox{\Hypertarget{group__sntp__opts_gafe340b98c52dedcbc041267fe13b2da6}\label{group__sntp__opts_gafe340b98c52dedcbc041267fe13b2da6}} 
\index{Options@{Options}!SNTP\_SET\_SYSTEM\_TIME@{SNTP\_SET\_SYSTEM\_TIME}}
\index{SNTP\_SET\_SYSTEM\_TIME@{SNTP\_SET\_SYSTEM\_TIME}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_SET\_SYSTEM\_TIME}{SNTP\_SET\_SYSTEM\_TIME}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME(\begin{DoxyParamCaption}\item[{}]{sec }\end{DoxyParamCaption})~\mbox{\hyperlink{group__compiler__abstraction_ga70624a5deb8b9199406372a7f3603ecf}{LWIP\+\_\+\+UNUSED\+\_\+\+ARG}}(sec)}

SNTP macro to change system time in seconds Define SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+US(sec, us) to set the time in microseconds instead of this one if you need the additional precision. Alternatively, define SNTP\+\_\+\+SET\+\_\+\+SYSTEM\+\_\+\+TIME\+\_\+\+NTP(sec, frac) in order to work with native NTP timestamps instead. \mbox{\Hypertarget{group__sntp__opts_ga22017d43da7d4bf8d42e786b4ced4dfa}\label{group__sntp__opts_ga22017d43da7d4bf8d42e786b4ced4dfa}} 
\index{Options@{Options}!SNTP\_STARTUP\_DELAY@{SNTP\_STARTUP\_DELAY}}
\index{SNTP\_STARTUP\_DELAY@{SNTP\_STARTUP\_DELAY}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_STARTUP\_DELAY}{SNTP\_STARTUP\_DELAY}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+STARTUP\+\_\+\+DELAY~0}

According to the RFC, this shall be a random delay between 1 and 5 minutes (in milliseconds) to prevent load peaks. This can be defined to a random generation function, which must return the delay in milliseconds as u32\+\_\+t. Turned off by default. \mbox{\Hypertarget{group__sntp__opts_gae082c2f3044d500ca5e1be1d4928de75}\label{group__sntp__opts_gae082c2f3044d500ca5e1be1d4928de75}} 
\index{Options@{Options}!SNTP\_STARTUP\_DELAY\_FUNC@{SNTP\_STARTUP\_DELAY\_FUNC}}
\index{SNTP\_STARTUP\_DELAY\_FUNC@{SNTP\_STARTUP\_DELAY\_FUNC}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_STARTUP\_DELAY\_FUNC}{SNTP\_STARTUP\_DELAY\_FUNC}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+STARTUP\+\_\+\+DELAY\+\_\+\+FUNC~(LWIP\+\_\+\+RAND() \% 5000)}

If you want the startup delay to be a function, define this to a function (including the brackets) and define SNTP\+\_\+\+STARTUP\+\_\+\+DELAY to 1. \mbox{\Hypertarget{group__sntp__opts_ga9232c56443115be05a2f852eba21979c}\label{group__sntp__opts_ga9232c56443115be05a2f852eba21979c}} 
\index{Options@{Options}!SNTP\_UPDATE\_DELAY@{SNTP\_UPDATE\_DELAY}}
\index{SNTP\_UPDATE\_DELAY@{SNTP\_UPDATE\_DELAY}!Options@{Options}}
\doxysubsubsection{\texorpdfstring{SNTP\_UPDATE\_DELAY}{SNTP\_UPDATE\_DELAY}}
{\footnotesize\ttfamily \#define SNTP\+\_\+\+UPDATE\+\_\+\+DELAY~3600000}

SNTP update delay -\/ in milliseconds Default is 1 hour. Must not be beolw 60 seconds by specification (i.\+e. 60000) 