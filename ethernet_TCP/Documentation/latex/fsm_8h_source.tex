\hypertarget{fsm_8h_source}{}\doxysection{fsm.\+h}
\label{fsm_8h_source}\index{C:/Users/User\_4/STM32CubeIDE/workspace\_1.10.1/ethernet\_UDB/Middlewares/Third\_Party/LwIP/src/include/netif/ppp/fsm.h@{C:/Users/User\_4/STM32CubeIDE/workspace\_1.10.1/ethernet\_UDB/Middlewares/Third\_Party/LwIP/src/include/netif/ppp/fsm.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * fsm.h -\/ \{Link, IP\} Control Protocol Finite State Machine definitions.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Copyright (c) 1984-\/2000 Carnegie Mellon University. All rights reserved.}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{7 \textcolor{comment}{ * modification, are permitted provided that the following conditions}}
\DoxyCodeLine{8 \textcolor{comment}{ * are met:}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * 1. Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{11 \textcolor{comment}{ *    notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{12 \textcolor{comment}{ *}}
\DoxyCodeLine{13 \textcolor{comment}{ * 2. Redistributions in binary form must reproduce the above copyright}}
\DoxyCodeLine{14 \textcolor{comment}{ *    notice, this list of conditions and the following disclaimer in}}
\DoxyCodeLine{15 \textcolor{comment}{ *    the documentation and/or other materials provided with the}}
\DoxyCodeLine{16 \textcolor{comment}{ *    distribution.}}
\DoxyCodeLine{17 \textcolor{comment}{ *}}
\DoxyCodeLine{18 \textcolor{comment}{ * 3. The name "{}Carnegie Mellon University"{} must not be used to}}
\DoxyCodeLine{19 \textcolor{comment}{ *    endorse or promote products derived from this software without}}
\DoxyCodeLine{20 \textcolor{comment}{ *    prior written permission. For permission or any legal}}
\DoxyCodeLine{21 \textcolor{comment}{ *    details, please contact}}
\DoxyCodeLine{22 \textcolor{comment}{ *      Office of Technology Transfer}}
\DoxyCodeLine{23 \textcolor{comment}{ *      Carnegie Mellon University}}
\DoxyCodeLine{24 \textcolor{comment}{ *      5000 Forbes Avenue}}
\DoxyCodeLine{25 \textcolor{comment}{ *      Pittsburgh, PA  15213-\/3890}}
\DoxyCodeLine{26 \textcolor{comment}{ *      (412) 268-\/4387, fax: (412) 268-\/7395}}
\DoxyCodeLine{27 \textcolor{comment}{ *      tech-\/transfer@andrew.cmu.edu}}
\DoxyCodeLine{28 \textcolor{comment}{ *}}
\DoxyCodeLine{29 \textcolor{comment}{ * 4. Redistributions of any form whatsoever must retain the following}}
\DoxyCodeLine{30 \textcolor{comment}{ *    acknowledgment:}}
\DoxyCodeLine{31 \textcolor{comment}{ *    "{}This product includes software developed by Computing Services}}
\DoxyCodeLine{32 \textcolor{comment}{ *     at Carnegie Mellon University (http://www.cmu.edu/computing/)."{}}}
\DoxyCodeLine{33 \textcolor{comment}{ *}}
\DoxyCodeLine{34 \textcolor{comment}{ * CARNEGIE MELLON UNIVERSITY DISCLAIMS ALL WARRANTIES WITH REGARD TO}}
\DoxyCodeLine{35 \textcolor{comment}{ * THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY}}
\DoxyCodeLine{36 \textcolor{comment}{ * AND FITNESS, IN NO EVENT SHALL CARNEGIE MELLON UNIVERSITY BE LIABLE}}
\DoxyCodeLine{37 \textcolor{comment}{ * FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES}}
\DoxyCodeLine{38 \textcolor{comment}{ * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN}}
\DoxyCodeLine{39 \textcolor{comment}{ * AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING}}
\DoxyCodeLine{40 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.}}
\DoxyCodeLine{41 \textcolor{comment}{ *}}
\DoxyCodeLine{42 \textcolor{comment}{ * \$Id: fsm.h,v 1.10 2004/11/13 02:28:15 paulus Exp \$}}
\DoxyCodeLine{43 \textcolor{comment}{ */}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{preprocessor}{\#include "{}netif/ppp/ppp\_opts.h"{}}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#if PPP\_SUPPORT }\textcolor{comment}{/* don't build if not configured for use in lwipopts.h */}\textcolor{preprocessor}{}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#ifndef FSM\_H}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#define FSM\_H}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{preprocessor}{\#include "{}ppp.h"{}}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{54 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{comment}{/*}}
\DoxyCodeLine{58 \textcolor{comment}{ * Packet header = Code, id, length.}}
\DoxyCodeLine{59 \textcolor{comment}{ */}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#define HEADERLEN   4}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{comment}{/*}}
\DoxyCodeLine{64 \textcolor{comment}{ *  CP (LCP, IPCP, etc.) codes.}}
\DoxyCodeLine{65 \textcolor{comment}{ */}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#define CONFREQ     1   }\textcolor{comment}{/* Configuration Request */}\textcolor{preprocessor}{}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#define CONFACK     2   }\textcolor{comment}{/* Configuration Ack */}\textcolor{preprocessor}{}}
\DoxyCodeLine{68 \textcolor{preprocessor}{\#define CONFNAK     3   }\textcolor{comment}{/* Configuration Nak */}\textcolor{preprocessor}{}}
\DoxyCodeLine{69 \textcolor{preprocessor}{\#define CONFREJ     4   }\textcolor{comment}{/* Configuration Reject */}\textcolor{preprocessor}{}}
\DoxyCodeLine{70 \textcolor{preprocessor}{\#define TERMREQ     5   }\textcolor{comment}{/* Termination Request */}\textcolor{preprocessor}{}}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#define TERMACK     6   }\textcolor{comment}{/* Termination Ack */}\textcolor{preprocessor}{}}
\DoxyCodeLine{72 \textcolor{preprocessor}{\#define CODEREJ     7   }\textcolor{comment}{/* Code Reject */}\textcolor{preprocessor}{}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{comment}{/*}}
\DoxyCodeLine{76 \textcolor{comment}{ * Each FSM is described by an fsm structure and fsm callbacks.}}
\DoxyCodeLine{77 \textcolor{comment}{ */}}
\DoxyCodeLine{78 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }fsm \{}
\DoxyCodeLine{79     ppp\_pcb *pcb;       \textcolor{comment}{/* PPP Interface */}}
\DoxyCodeLine{80     \textcolor{keyword}{const} \textcolor{keyword}{struct }fsm\_callbacks *callbacks;  \textcolor{comment}{/* Callback routines */}}
\DoxyCodeLine{81     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *term\_reason;    \textcolor{comment}{/* Reason for closing protocol */}}
\DoxyCodeLine{82     u8\_t seen\_ack;      \textcolor{comment}{/* Have received valid Ack/Nak/Rej to Req */}}
\DoxyCodeLine{83                   \textcolor{comment}{/* -\/-\/ This is our only flag, we might use u\_int :1 if we have more flags */}}
\DoxyCodeLine{84     u16\_t protocol;     \textcolor{comment}{/* Data Link Layer Protocol field value */}}
\DoxyCodeLine{85     u8\_t state;         \textcolor{comment}{/* State */}}
\DoxyCodeLine{86     u8\_t flags;         \textcolor{comment}{/* Contains option bits */}}
\DoxyCodeLine{87     u8\_t id;            \textcolor{comment}{/* Current id */}}
\DoxyCodeLine{88     u8\_t reqid;         \textcolor{comment}{/* Current request id */}}
\DoxyCodeLine{89     u8\_t retransmits;       \textcolor{comment}{/* Number of retransmissions left */}}
\DoxyCodeLine{90     u8\_t nakloops;      \textcolor{comment}{/* Number of nak loops since last ack */}}
\DoxyCodeLine{91     u8\_t rnakloops;     \textcolor{comment}{/* Number of naks received */}}
\DoxyCodeLine{92     u8\_t maxnakloops;       \textcolor{comment}{/* Maximum number of nak loops tolerated}}
\DoxyCodeLine{93 \textcolor{comment}{                   (necessary because IPCP require a custom large max nak loops value) */}}
\DoxyCodeLine{94     u8\_t term\_reason\_len;   \textcolor{comment}{/* Length of term\_reason */}}
\DoxyCodeLine{95 \} fsm;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }fsm\_callbacks \{}
\DoxyCodeLine{99     void (*resetci)     \textcolor{comment}{/* Reset our Configuration Information */}}
\DoxyCodeLine{100         (fsm *);}
\DoxyCodeLine{101     int  (*cilen)       \textcolor{comment}{/* Length of our Configuration Information */}}
\DoxyCodeLine{102         (fsm *);}
\DoxyCodeLine{103     void (*addci)       \textcolor{comment}{/* Add our Configuration Information */}}
\DoxyCodeLine{104         (fsm *, u\_char *, \textcolor{keywordtype}{int} *);}
\DoxyCodeLine{105     int  (*ackci)       \textcolor{comment}{/* ACK our Configuration Information */}}
\DoxyCodeLine{106         (fsm *, u\_char *, int);}
\DoxyCodeLine{107     int  (*nakci)       \textcolor{comment}{/* NAK our Configuration Information */}}
\DoxyCodeLine{108         (fsm *, u\_char *, int, int);}
\DoxyCodeLine{109     int  (*rejci)       \textcolor{comment}{/* Reject our Configuration Information */}}
\DoxyCodeLine{110         (fsm *, u\_char *, int);}
\DoxyCodeLine{111     int  (*reqci)       \textcolor{comment}{/* Request peer's Configuration Information */}}
\DoxyCodeLine{112         (fsm *, u\_char *, \textcolor{keywordtype}{int} *, int);}
\DoxyCodeLine{113     void (*up)          \textcolor{comment}{/* Called when fsm reaches PPP\_FSM\_OPENED state */}}
\DoxyCodeLine{114         (fsm *);}
\DoxyCodeLine{115     void (*down)        \textcolor{comment}{/* Called when fsm leaves PPP\_FSM\_OPENED state */}}
\DoxyCodeLine{116         (fsm *);}
\DoxyCodeLine{117     void (*starting)        \textcolor{comment}{/* Called when we want the lower layer */}}
\DoxyCodeLine{118         (fsm *);}
\DoxyCodeLine{119     void (*finished)        \textcolor{comment}{/* Called when we don't want the lower layer */}}
\DoxyCodeLine{120         (fsm *);}
\DoxyCodeLine{121     void (*protreject)      \textcolor{comment}{/* Called when Protocol-\/Reject received */}}
\DoxyCodeLine{122         (int);}
\DoxyCodeLine{123     void (*retransmit)      \textcolor{comment}{/* Retransmission is necessary */}}
\DoxyCodeLine{124         (fsm *);}
\DoxyCodeLine{125     int  (*extcode)     \textcolor{comment}{/* Called when unknown code received */}}
\DoxyCodeLine{126         (fsm *, int, int, u\_char *, int);}
\DoxyCodeLine{127     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *proto\_name; \textcolor{comment}{/* String name for protocol (for messages) */}}
\DoxyCodeLine{128 \} fsm\_callbacks;}
\DoxyCodeLine{129 }
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{comment}{/*}}
\DoxyCodeLine{132 \textcolor{comment}{ * Link states.}}
\DoxyCodeLine{133 \textcolor{comment}{ */}}
\DoxyCodeLine{134 \textcolor{preprocessor}{\#define PPP\_FSM\_INITIAL     0   }\textcolor{comment}{/* Down, hasn't been opened */}\textcolor{preprocessor}{}}
\DoxyCodeLine{135 \textcolor{preprocessor}{\#define PPP\_FSM\_STARTING    1   }\textcolor{comment}{/* Down, been opened */}\textcolor{preprocessor}{}}
\DoxyCodeLine{136 \textcolor{preprocessor}{\#define PPP\_FSM\_CLOSED      2   }\textcolor{comment}{/* Up, hasn't been opened */}\textcolor{preprocessor}{}}
\DoxyCodeLine{137 \textcolor{preprocessor}{\#define PPP\_FSM\_STOPPED     3   }\textcolor{comment}{/* Open, waiting for down event */}\textcolor{preprocessor}{}}
\DoxyCodeLine{138 \textcolor{preprocessor}{\#define PPP\_FSM\_CLOSING     4   }\textcolor{comment}{/* Terminating the connection, not open */}\textcolor{preprocessor}{}}
\DoxyCodeLine{139 \textcolor{preprocessor}{\#define PPP\_FSM\_STOPPING    5   }\textcolor{comment}{/* Terminating, but open */}\textcolor{preprocessor}{}}
\DoxyCodeLine{140 \textcolor{preprocessor}{\#define PPP\_FSM\_REQSENT     6   }\textcolor{comment}{/* We've sent a Config Request */}\textcolor{preprocessor}{}}
\DoxyCodeLine{141 \textcolor{preprocessor}{\#define PPP\_FSM\_ACKRCVD     7   }\textcolor{comment}{/* We've received a Config Ack */}\textcolor{preprocessor}{}}
\DoxyCodeLine{142 \textcolor{preprocessor}{\#define PPP\_FSM\_ACKSENT     8   }\textcolor{comment}{/* We've sent a Config Ack */}\textcolor{preprocessor}{}}
\DoxyCodeLine{143 \textcolor{preprocessor}{\#define PPP\_FSM\_OPENED      9   }\textcolor{comment}{/* Connection available */}\textcolor{preprocessor}{}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{comment}{/*}}
\DoxyCodeLine{147 \textcolor{comment}{ * Flags -\/ indicate options controlling FSM operation}}
\DoxyCodeLine{148 \textcolor{comment}{ */}}
\DoxyCodeLine{149 \textcolor{preprocessor}{\#define OPT\_PASSIVE 1   }\textcolor{comment}{/* Don't die if we don't get a response */}\textcolor{preprocessor}{}}
\DoxyCodeLine{150 \textcolor{preprocessor}{\#define OPT\_RESTART 2   }\textcolor{comment}{/* Treat 2nd OPEN as DOWN, UP */}\textcolor{preprocessor}{}}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#define OPT\_SILENT  4   }\textcolor{comment}{/* Wait for peer to speak first */}\textcolor{preprocessor}{}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{comment}{/*}}
\DoxyCodeLine{155 \textcolor{comment}{ * Timeouts.}}
\DoxyCodeLine{156 \textcolor{comment}{ */}}
\DoxyCodeLine{157 \textcolor{preprocessor}{\#if 0 }\textcolor{comment}{/* moved to ppp\_opts.h */}\textcolor{preprocessor}{}}
\DoxyCodeLine{158 \textcolor{preprocessor}{\#define DEFTIMEOUT  3   }\textcolor{comment}{/* Timeout time in seconds */}\textcolor{preprocessor}{}}
\DoxyCodeLine{159 \textcolor{preprocessor}{\#define DEFMAXTERMREQS  2   }\textcolor{comment}{/* Maximum Terminate-\/Request transmissions */}\textcolor{preprocessor}{}}
\DoxyCodeLine{160 \textcolor{preprocessor}{\#define DEFMAXCONFREQS  10  }\textcolor{comment}{/* Maximum Configure-\/Request transmissions */}\textcolor{preprocessor}{}}
\DoxyCodeLine{161 \textcolor{preprocessor}{\#define DEFMAXNAKLOOPS  5   }\textcolor{comment}{/* Maximum number of nak loops */}\textcolor{preprocessor}{}}
\DoxyCodeLine{162 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* moved to ppp\_opts.h */}\textcolor{preprocessor}{}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 }
\DoxyCodeLine{165 \textcolor{comment}{/*}}
\DoxyCodeLine{166 \textcolor{comment}{ * Prototypes}}
\DoxyCodeLine{167 \textcolor{comment}{ */}}
\DoxyCodeLine{168 \textcolor{keywordtype}{void} fsm\_init(fsm *f);}
\DoxyCodeLine{169 \textcolor{keywordtype}{void} fsm\_lowerup(fsm *f);}
\DoxyCodeLine{170 \textcolor{keywordtype}{void} fsm\_lowerdown(fsm *f);}
\DoxyCodeLine{171 \textcolor{keywordtype}{void} fsm\_open(fsm *f);}
\DoxyCodeLine{172 \textcolor{keywordtype}{void} fsm\_close(fsm *f, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *reason);}
\DoxyCodeLine{173 \textcolor{keywordtype}{void} fsm\_input(fsm *f, u\_char *inpacket, \textcolor{keywordtype}{int} l);}
\DoxyCodeLine{174 \textcolor{keywordtype}{void} fsm\_protreject(fsm *f);}
\DoxyCodeLine{175 \textcolor{keywordtype}{void} fsm\_sdata(fsm *f, u\_char code, u\_char \textcolor{keywordtype}{id}, \textcolor{keyword}{const} u\_char *data, \textcolor{keywordtype}{int} datalen);}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{178 \}}
\DoxyCodeLine{179 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* FSM\_H */}\textcolor{preprocessor}{}}
\DoxyCodeLine{182 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* PPP\_SUPPORT */}\textcolor{preprocessor}{}}

\end{DoxyCode}
